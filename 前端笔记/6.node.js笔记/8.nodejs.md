

# 1.初识Node.js与内置模块

## 1.初识Node.js

### 1.1回顾与思考

#### 1.已经掌握了哪些技术

- HTML
- CSS
- JavaScript

#### 2.浏览器中的JavaScript的组成部分

![image-20230714200913384](../img/image-20230714200913384.png)

#### 3.思考：为什么JavaScript可以在浏览器中被执行

不同的浏览器使用不同的JavaScript解析引擎：

- Chrome 浏览器=》V8
- Firefox 浏览器 =》OdinMonkey（奥丁猴）
- Safri 浏览器=》JSCore
- IE浏览器=》Chakra（查克拉）
- etc...

其中，Chrome浏览器的V8解析引擎性能最好！

#### 4.思考：为什么JavaScript可以操作DOM和BOM

每个浏览器都内置了DOM、BOM这样的API函数，因此，浏览器中的JavaScript才可以调用它们

#### 5.浏览器中的JavaScript运行环境

运行环境是指代码正常运行所必需的必要环境

![image-20230714202217733](../img/image-20230714202217733.png)

总结：

1. V8引擎负责解析和执行JavaScript代码
2. 内置API是由运行环境提供的特殊接口，只能在所属的运行环境中被调用

#### 6.思考：JavaScript能否做后端开发

可以但是需要借助node.js的运行环境

### 1.2Node.js简介

### 1.什么是Node.js

Node,js is a JavaScript runtime built on Chrome's V8 JavaScript engine.
Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。

 Node.js的官网地址：http://nodejs.org/zh-cn/

#### 2.Node.js的JavaScript运行环境

![image-20230714203938223](../img/image-20230714203938223.png)

注意：

1. 浏览器是JavaScript的前端运行环境
2. Node.js是JavaScript的后端运行环境
3. Node.js中无法调用DOM和BOM等浏览器内置API

#### 3.Node.js可以做什么

Nodejs 作为一个JavaScript 的运行环境，仅仅提供了基础的功能和 AP1。然而，基于 Node.js 提供的这些基础工能，很多强大的工具和框架如雨后春笋，层出不穷，所以学会了 Node.js，可以让前端程序员胜任更多的工作和岗位

1. 基于Express框架（http://www.expressjs.com.cn/）可以快速构建Web
2. 基于Electron框架（https://electronjs.org/）
3. 基于restify框架（http://restify.com/）可以快速构建API接口项目
4. 读写和操作数据库、创建实用的命令行工具辅助前端开发、etc...

Node.js的学习路径：

JavaScript基础语法+Node.js内置API模块（fs.path.http等）+第三方API模块（express、mysql等）

### 1.3Node.js环境的安装

如果希望通过Node.js来运行JavaScript代码，则必须在计算机上安装Node.js环境才行

http://nodejs.org/en/

#### 1.区分LTS版本和Current版本的不同

- LTS为长期稳定版，对于追求稳定性的企业级项目来说，推荐安装LTS版本的Node.js
- Current 为新特性尝鲜版，对热衷于尝试新特性的用户来说，推荐安装 Current 版本的 Node.js。但是Current 版本中可能存在隐藏的 Bug或安全性漏洞，因此不推荐在企业级项目中使用Current 版本的 Node.js。

#### 2.查看已安装的Node.js的版本号

打开终端，在终端输入命令node -v后。按下回车键，即可查看已安装的Node.js的版本号

#### 3.什么是终端

终端（英文：Terminal）是专门为开发人员设计的，用于实现人机交互的一种方式

作为一名合格的程序员，我们有必要识记一些常用的终端命令，来协助我们更好的操作与使用计算机

### 1.4在Node.js环境下执行JavaScript代码

1. 打开终端
2. 输入node要执行的js文件的路径

#### 1.终端里的快捷键

在Windows的powershell或cmd终端中，我们可以通过如下快捷键，来提高终端的操作效率：

1. 使用上方向键，可以快速定位到上一次执行的命令
2. 使用tab键，能够快速补全路径
3. 使用esc键，能够快速清空当前已输入的命令
4. 输入cls命令，可以清空终端

## 2.fs文件系统模块

### 2.1什么是fs文件系统模块

fs模块是Node.js官方提供的，用来操作文件的模版，他提供了一系列的方法和属性，用来满足用户对文件的操作需求

例如：

- fs.readFile()方法，用来读取指定文件中的内容
- fs.writeFile()方法，用来向指定的文件中写入内容

如果要在JavaScript代码中，使用fs模版来操作文件，则需要使用如下的方式先导入它：

```javascript
const fs =require('fs')
```

### 2.2读取指定文件中的内容

#### 1. fs.readFile（）的语法格式

使用fs.readFile()可以读取指定文件中的内容，语法格式如下：

```js
fs.readFile(path[,options],callback)
```

参数解读：

- 参数1：==必选==参数，字符串、表示文件的路径
- 参数2：可选参数，表示以什么==编码格式==来读取文件
- 参数3：==必选==参数，文件读取完成后，通过回调函数拿到读取的结果

#### 2.fs.readFile()的示例代码

以utf8的编码格式，读取指定文件的内容，并打印err和dataStr的值：

```js
const fs=require('fs')
fs.readFile('./files/11.text','utf8',function(err,dataStr){
console.log(err)
console.log('-----')
console.log('dataStr')
})
```

#### 3.判断文件是否读取成功

可以判断err对象是否为空，从而知晓文件读取结果

### 2.3向指定文件中写入内容

#### 1. fs.writeFile()的语法格式

```js
fs.writeFile(file,data[.options],callback)
```

参数解读：

1. 参数1：==必选==参数，需要指定一个文件路径的字符串，表示文件的存放路径
2. 参数2：==必选==参数，表示要写入的内容
3. 参数3：可选参数，表示以什么格式写入文件内容，默认是utf8
4. 参数4：==必选==参数，文件写入完成后的回调函数

#### 2.fs.writeFile()的示例代码

向指定的文件路径，写入文件内容

```js
const fs=require('fs')
fs.writeFile('./2.txt','Hello Node.js!',function(err){
console.log(err)
})
```

如果文件写入成功，则err的值等于null

如果写入失败，则err的值等于一个 错误对象

#### 3.判断文件是否写入成功

可以判断err对象是否为null，从而知晓文件写入结果

```js
fs.writeFile('./files/3.txt', 'ok123', function(err) {
  // 2.1 如果文件写入成功，则 err 的值等于 null
  // 2.2 如果文件写入失败，则 err 的值等于一个 错误对象
  // console.log(err)

  if (err) {
    return console.log('文件写入失败！' + err.message)
  }
  console.log('文件写入成功！')
})

```

### 2.4fs模块-路径动态拼接的问题

在使用fs模块操作文件时，如果提供的路径是以./或../开头的==相对路径==时，很容易出现路径动态拼接错误的问题

原因：代码在运行的时候，==会以执行node命令时所处的目录==，动态拼接出被操作文件的1完整路径

解决方案：直接提供完整路径 （注意将\改为 \ \ ) 

弊端：移植性非常差，不利于维护

更好的解决方案在相对路径见面去掉.加上__dirname

## 3.path路径模块

### 3.1什么是path路径模块

==path 模块==是Node.js官方提供的，用于==处理路径==的模块，他提供了一系列的方法和属性，用来满足用户对路径的处理需求

例如：

- path.join()方法，用来将==多个路径片段拼接成一个完整的路径字符串==
- path.basename()方法，用于从路径字符串中，将文件名解析出来

如果要在JavaScript代码中，使用path模块来处理路径，则需要使用如下的方式先导入它：

```js
const path =require('path')
```

#### 1. path.join()的语法格式

使用path.join方法可以把多个路径片段拼接为完整的路径字符串，语法格式如下：

```js
path.join([...paths])
```

参数解读：

- ...paths<string>路径片段的序列
- 返回值：<string>

#### 2.path.join()的代码示例

使用path.join()方法，可以把多个路径片段拼接为完整的路径字符串

```js
const pathStr=path.join('/a','/b/c','../','./d','e')
console.log(pathStr)//输出\a\b\d\e
//注意../会抵消一层路径这个路径是离他最近的路径
const pathStr2=path.join(_dirname,'./files/1.txt')
console.log(pathStr2)//输出 当前文件所处的目录\files\1.txt
```

注意：==今后凡是涉及到路径拼接的操作，都要使用path.join()方法进行处理==不要直接使用+进行字符串的拼接

### 3.2获取路径中的文件名

#### 1.path.basename()的语法格式

使用path.basename()方法，可以获取路径中的最后一部分，经常通过这个方法获取路径中的文件名，语法格式如下：

```js
path.basename(path[,ext])
```

参数解读：

- path<string>必选参数，表示一个路径的字符串
- ext<string>可选参数，表示文件扩展名
- 返回：<string>表示路径中的最后一部分

#### 2.path.basename()的代码示例

使用path.basename()方法，可以从一个文件路径中，获取到文件的名称部分

### 3.3获取路径中的文件扩展名

#### 1. path.extname()的语法格式

使用path.extname()方法，可以获取路径中的扩展名部分，语法格式如下：

```js
path.extname(path)
```

参数解读：

- path<string>必选参数，表示一个路径的字符串
- 返回<string>返回得到的扩展名字符串

#### 2.path.extname()的代码示例

使用path.extname()方法可以获取路径中的扩展名部分

```js
const fpath='/a/b/c/index.html'//路径字符串


const fext=path.extname(fpath)
console.log(fext)//输出 .html
```

## 4.http模块



### 4.1什么是http模块



回顾：什么是==客户端==、什么是==服务器==

在网络节点中，负责消费资源的电脑，叫做客户端；==负责对外提供网络资源==的电脑，叫做服务器

==http模块==是Node.js官方提供的，用来==创建web服务器==的模块。通过http模块提供的httpcreatServer()方法，就能方便的把一台普通的电脑，变成一台Web服务器，从而对外提供Web资源服务

如果希望使用http模块创建Web服务器，则需要先导入它：

```js
const http=require('http')
```

### 4.2进一步理解http模块的作用

服务器和普通电脑的==区别==就在于服务器上安装了==web服务器软件==，例如：IIS.Aspache等。通过安装这些服务器软件就能把一台普通的电脑变成一台web服务器

在Node.js中我们不需要使用IIS.Apache等这些第三方软件，因为我们可以口语Node.js提供的Http模块，==通过几行简单的代码，就能轻松手写一个服务器软件===从而对外进行web服务

### 4.3服务器相关概念

#### 1.IP地址

==IP地址==就是互联网上==每个计算机的唯一地址==，因此IP地址具有唯一性。如果把''把个人电脑“比作“一台电话”，那么“IP地址”就相当于“电话号码”，只有在知道对方IP地址的前提下，才能与对应的电脑进行数据通信

IP地址的格式：通常用“==点分十进制==”表示（==a.b.c.d==）的形式，其中a.b.c.d都是0-255之间的十进制整数。例如：用点分十进制表示的IP地址（192.168.1.1）

注意：

1. 互联网中每台Web服务器，都有自己的IP地址，例如：大家大家可以在Windows的终端进行==ping www.baidu. com==命令。即可查看百度服务器的IP地址
2. 在开发期间，自己的电脑既是一台服务器也是一个客户端，为了方便测试，可以在自己的浏览器中输入 127.0.0.1这个ip地址，就能1把自己的电脑当做一台服务器进行访问了

#### 2.域名和域名服务器相关的概念

尽管IP地址能够标记网络上的计算机，但是IP地址是一长串数字，不直观，而且不方便记忆，于是人们又发明了另一套字符型的地址方案即所谓的域名（DomainName）地址

IP地址和域名是——对应的关系，这份对应关系存放在一种叫==域名服务器==（DNS，Domain name server）的电脑中。使用者只需要通过好记得域名进行访问对应的服务器即可，对应的转换工作由域名服务器实现。因此，==域名服务器==就是提供IP地址和域名之间转换的服务器

注意：



1. 单纯使用IP地址，互联网中的电脑也能正常使用，但是有域名的加持，能够让互联网的世界变得更加方便
2. 在开发测试期间，==127.0.0.1==对应的域名是==localhost==，他们都代表我们自己的这台电脑，在使用效果上没有区别

#### 3.端口号

计算机中的端口号，就好像现实生活中的门牌号一样，通过门牌号，外卖小哥可以在整栋大楼里的众多房间把外卖送到你的手里

同样的道理，在一台电脑中，可以运行成百上千个web服务器。每个服务器都对应一个唯一的端口号。客户端发送过来的网络请求，通过端口号，可以准确地交给==对应的web服务器==进行处理

### 4.4创建最基本的web服务器

#### 1.创建web服务器的基本步骤

1. 导入http模块
2. 创建web服务器实例
3. 为服务器实例绑定==request==事件，监听客户端的请求
4. 启动服务器

#### 2.步骤1-导入http模块

如果希望在自己的电脑上创建一个文本服务器，从而对外提供web

服务，则需要导入http模块

```js
const http=require('http')
```

#### 2.步骤2-创建web服务器实例

调用http.createServer()方法，即可快速创建一个web服务器实例：

```js
const server=http.creatServer()
```

#### 2.步骤3-为服务器实例化绑定request事件

为服务器实例绑定request事件，即可监听客户端发送过来的数据请求：

```js
//使用服务器实例化的 .on()方法，为服务器绑定一个request事件
server.on('require',(req,res)=>{
//只要有客户端来请求我们自己的服务器，就会触发request事件，从而调用这个事件处理函数

console.log('Someone visit our web server.')
})
```

#### 2.步骤4-启动服务器

调用服务器实例化的.listen()方法，即可启动当前的web服务器实例：

```js
//调用server.listen(端口号，cb回调)方法，即可启动web服务器
server.listen(80,()=>{
console.log('http server running at http://127.0.0.1')
})
```

#### 3.==req==请求对象

只要服务器接收到了客户端的请求，就会调用通过server.on()为服务器绑定的request事件处理函数

如果想在事件处理函数中，==访问与客户端有关的数据或属性==，可以使用以下方式

```js
server.on('request',(req)=>{
//req是请求对象，它包含了与客户端相关的数据和属性，例如：
//req.url是客户端请求的URL地址
//req.method是客户端的method请求类型
const str=`Your request url is ${req.url},and request method is ${req.method}`
console.log(str)
})
```

#### 4.res响应对象

在服务器的request事件处理函数中如果想访问与服务器相关的数据或属性，可以使用如下的方式：

#### 5.解决中文乱码问题

当调用res.end()方法，向客户端发送中文内容的时候，会出现乱码问题，此时，需要手动设置内容的编码格式：
